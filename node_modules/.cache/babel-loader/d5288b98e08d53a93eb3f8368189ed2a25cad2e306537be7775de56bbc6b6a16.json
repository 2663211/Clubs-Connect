{"ast":null,"code":"var _jsxFileName = \"C:\\\\Programming\\\\Clubs Connect\\\\Clubs-Connect\\\\src\\\\components\\\\ExecPost.js\",\n  _s = $RefreshSig$();\n// ExecPost.js\nimport React, { useState, useEffect } from \"react\";\nimport { supabase } from \"../supabaseClient\";\nimport '../styles/ExecPost.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ExecPost({\n  entityId\n}) {\n  _s();\n  const [caption, setCaption] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  // Fetch logged-in user\n  useEffect(() => {\n    const fetchUser = async () => {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      setUser(user);\n    };\n    fetchUser();\n    const {\n      data: listener\n    } = supabase.auth.onAuthStateChange((_event, session) => {\n      setUser((session === null || session === void 0 ? void 0 : session.user) || null);\n    });\n    return () => listener.subscription.unsubscribe();\n  }, []);\n  const handleFileChange = e => setFile(e.target.files[0]);\n  const handleSubmit = async () => {\n    if (!user) return alert(\"You must be logged in to post.\");\n    if (!caption && !file) return alert(\"Please add a caption or select a file.\");\n    setLoading(true);\n    try {\n      let mediaUrl = null;\n      let mediaType = null;\n\n      // Only upload file if one was selected\n      if (file) {\n        // 1. Upload file to Supabase Storage\n        const fileExt = file.name.split(\".\").pop();\n        const filePath = `${user.id}/${Date.now()}.${fileExt}`;\n        const {\n          error: uploadError\n        } = await supabase.storage.from(\"media\").upload(filePath, file);\n        if (uploadError) throw uploadError;\n        const {\n          data\n        } = supabase.storage.from(\"media\").getPublicUrl(filePath);\n        mediaUrl = data.publicUrl;\n        mediaType = file.type.startsWith(\"image\") ? \"image\" : file.type.startsWith(\"video\") ? \"video\" : \"audio\";\n      }\n\n      // 2. Insert post with entityId\n      const {\n        error: insertError\n      } = await supabase.from(\"posts\").insert([{\n        caption: caption || null,\n        media_url: mediaUrl,\n        media_type: mediaType,\n        cso_id: entityId\n      }]);\n      if (insertError) throw insertError;\n      alert(\"Post created successfully!\");\n      setCaption(\"\");\n      setFile(null);\n      window.location.reload(); // Refresh to show new post\n    } catch (err) {\n      console.error(err);\n      alert(\"Error creating post: \" + err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"exec-post\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Create Post\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n      placeholder: \"Write your caption...\",\n      value: caption,\n      onChange: e => setCaption(e.target.value),\n      rows: 4,\n      className: \"post-caption-input\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      onChange: handleFileChange,\n      className: \"post-file-input\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSubmit,\n      disabled: loading || !caption && !file,\n      className: \"post-submit-button\",\n      children: loading ? \"Posting...\" : \"Post\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\n_s(ExecPost, \"ShL49UbvnoSmQOCGXzq0Q6nykhw=\");\n_c = ExecPost;\nvar _c;\n$RefreshReg$(_c, \"ExecPost\");","map":{"version":3,"names":["React","useState","useEffect","supabase","jsxDEV","_jsxDEV","ExecPost","entityId","_s","caption","setCaption","file","setFile","user","setUser","loading","setLoading","fetchUser","data","auth","getUser","listener","onAuthStateChange","_event","session","subscription","unsubscribe","handleFileChange","e","target","files","handleSubmit","alert","mediaUrl","mediaType","fileExt","name","split","pop","filePath","id","Date","now","error","uploadError","storage","from","upload","getPublicUrl","publicUrl","type","startsWith","insertError","insert","media_url","media_type","cso_id","window","location","reload","err","console","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","placeholder","value","onChange","rows","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Programming/Clubs Connect/Clubs-Connect/src/components/ExecPost.js"],"sourcesContent":["// ExecPost.js\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { supabase } from \"../supabaseClient\";\r\nimport '../styles/ExecPost.css';\r\n\r\nexport default function ExecPost({ entityId }) {\r\n  const [caption, setCaption] = useState(\"\");\r\n  const [file, setFile] = useState(null);\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Fetch logged-in user\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      setUser(user);\r\n    };\r\n    fetchUser();\r\n\r\n    const { data: listener } = supabase.auth.onAuthStateChange((_event, session) => {\r\n      setUser(session?.user || null);\r\n    });\r\n\r\n    return () => listener.subscription.unsubscribe();\r\n  }, []);\r\n\r\n  const handleFileChange = (e) => setFile(e.target.files[0]);\r\n\r\n  const handleSubmit = async () => {\r\n    if (!user) return alert(\"You must be logged in to post.\");\r\n    if (!caption && !file) return alert(\"Please add a caption or select a file.\");\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      let mediaUrl = null;\r\n      let mediaType = null;\r\n\r\n      // Only upload file if one was selected\r\n      if (file) {\r\n        // 1. Upload file to Supabase Storage\r\n        const fileExt = file.name.split(\".\").pop();\r\n        const filePath = `${user.id}/${Date.now()}.${fileExt}`;\r\n\r\n        const { error: uploadError } = await supabase.storage\r\n          .from(\"media\")\r\n          .upload(filePath, file);\r\n\r\n        if (uploadError) throw uploadError;\r\n\r\n        const { data } = supabase.storage.from(\"media\").getPublicUrl(filePath);\r\n        mediaUrl = data.publicUrl;\r\n\r\n        mediaType = file.type.startsWith(\"image\")\r\n          ? \"image\"\r\n          : file.type.startsWith(\"video\")\r\n          ? \"video\"\r\n          : \"audio\";\r\n      }\r\n\r\n      // 2. Insert post with entityId\r\n      const { error: insertError } = await supabase.from(\"posts\").insert([\r\n        {\r\n          caption: caption || null,\r\n          media_url: mediaUrl,\r\n          media_type: mediaType,\r\n          cso_id: entityId\r\n        }\r\n      ]);\r\n\r\n      if (insertError) throw insertError;\r\n\r\n      alert(\"Post created successfully!\");\r\n      setCaption(\"\");\r\n      setFile(null);\r\n      window.location.reload(); // Refresh to show new post\r\n\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"Error creating post: \" + err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"exec-post\">\r\n      <h3>Create Post</h3>\r\n\r\n      <textarea\r\n        placeholder=\"Write your caption...\"\r\n        value={caption}\r\n        onChange={(e) => setCaption(e.target.value)}\r\n        rows={4}\r\n        className=\"post-caption-input\"\r\n      />\r\n\r\n      <input \r\n        type=\"file\" \r\n        onChange={handleFileChange} \r\n        className=\"post-file-input\"\r\n      />\r\n\r\n      <button\r\n        onClick={handleSubmit}\r\n        disabled={loading || (!caption && !file)}\r\n        className=\"post-submit-button\"\r\n      >\r\n        {loading ? \"Posting...\" : \"Post\"}\r\n      </button>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}