{"ast":null,"code":"var _jsxFileName = \"C:\\\\Programming\\\\Clubs Connect\\\\Clubs-Connect\\\\src\\\\components\\\\addCSO.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '../supabaseClient';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction ExecutiveSearch({\n  executives,\n  selectedExecutives,\n  onAdd,\n  onRemove\n}) {\n  _s();\n  const [search, setSearch] = useState('');\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const filteredExecutives = executives.filter(exec => exec.name.toLowerCase().includes(search.toLowerCase()) && !selectedExecutives.find(selected => selected.id === exec.id));\n  const handleAdd = executive => {\n    onAdd(executive);\n    setSearch('');\n    setShowSuggestions(false);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"search\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"search\",\n        placeholder: \"Type to search executives...\",\n        value: search,\n        onChange: e => setSearch(e.target.value),\n        onFocus: () => setShowSuggestions(true),\n        \"aria-label\": \"Search executives\",\n        \"aria-autocomplete\": \"list\",\n        \"aria-expanded\": showSuggestions && search && filteredExecutives.length > 0\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 9\n      }, this), showSuggestions && search && filteredExecutives.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"suggestions-dropdown\",\n          role: \"listbox\",\n          children: filteredExecutives.map(exec => /*#__PURE__*/_jsxDEV(\"li\", {\n            onClick: () => handleAdd(exec),\n            role: \"option\",\n            tabIndex: 0,\n            onKeyDown: e => e.key === 'Enter' && handleAdd(exec),\n            children: exec.name\n          }, exec.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 41,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"overlay\",\n          onClick: () => setShowSuggestions(false),\n          \"aria-label\": \"Close suggestions\",\n          type: \"button\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 7\n    }, this), selectedExecutives.length > 0 && /*#__PURE__*/_jsxDEV(\"output\", {\n      \"aria-label\": \"Selected executives\",\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Selected executives:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"executive-chips\",\n        children: selectedExecutives.map(exec => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"chip\",\n          children: [exec.name, /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => onRemove(exec.id),\n            \"aria-label\": `Remove ${exec.name}`,\n            className: \"remove-btn\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 17\n          }, this)]\n        }, exec.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n_s(ExecutiveSearch, \"ycGAYQiDumUDs1OaF+pcyS8g/8o=\");\n_c = ExecutiveSearch;\nfunction AddCSO() {\n  _s2();\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    name: '',\n    description: '',\n    cluster: '',\n    subscription: '',\n    executives: []\n  });\n  const [logoFile, setLogoFile] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [status, setStatus] = useState({\n    type: null,\n    message: null\n  });\n  const [executives, setExecutives] = useState([]);\n  const [selectedExecutives, setSelectedExecutives] = useState([]);\n  useEffect(() => {\n    fetchExecutives();\n  }, []);\n  const fetchExecutives = async () => {\n    try {\n      const {\n        data: execData,\n        error: execError\n      } = await supabase.from('executive').select('id, \"student/staff_number\"');\n      if (execError) throw execError;\n      if ((execData === null || execData === void 0 ? void 0 : execData.length) > 0) {\n        const studentNumbers = execData.map(exec => exec['student/staff_number']).filter(Boolean);\n        if (studentNumbers.length > 0) {\n          const {\n            data: profileData,\n            error: profileError\n          } = await supabase.from('profiles').select('id, full_name').in('id', studentNumbers);\n          if (profileError) throw profileError;\n          const executivesWithNames = execData.map(exec => {\n            const profile = profileData === null || profileData === void 0 ? void 0 : profileData.find(p => p.id === exec['student/staff_number']);\n            return {\n              id: exec.id,\n              student_staff_number: exec['student/staff_number'],\n              name: (profile === null || profile === void 0 ? void 0 : profile.full_name) || 'Unknown Executive'\n            };\n          });\n          setExecutives(executivesWithNames);\n        }\n      }\n    } catch (err) {\n      console.error('Error fetching executives:', err);\n      setStatus({\n        type: 'error',\n        message: 'Failed to load executives'\n      });\n    }\n  };\n  const handleAddExecutive = executive => {\n    setSelectedExecutives([...selectedExecutives, executive]);\n    setFormData(prev => ({\n      ...prev,\n      executives: [...prev.executives, executive.id]\n    }));\n  };\n  const handleRemoveExecutive = executiveId => {\n    setSelectedExecutives(prev => prev.filter(exec => exec.id !== executiveId));\n    setFormData(prev => ({\n      ...prev,\n      executives: prev.executives.filter(id => id !== executiveId)\n    }));\n  };\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const handleFileChange = e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    if (!file.type.startsWith('image/')) {\n      setStatus({\n        type: 'error',\n        message: 'Please select an image file'\n      });\n      return;\n    }\n    if (file.size > 5 * 1024 * 1024) {\n      setStatus({\n        type: 'error',\n        message: 'File size must be less than 5MB'\n      });\n      return;\n    }\n    setLogoFile(file);\n    setStatus({\n      type: null,\n      message: null\n    });\n  };\n  const uploadLogo = async file => {\n    const fileExt = file.name.split('.').pop();\n    const fileName = `${Date.now()}-${Math.random()}.${fileExt}`;\n    const {\n      data,\n      error\n    } = await supabase.storage.from('cso-logos') // Use the new bucket\n    .upload(fileName, file);\n    if (error) throw error;\n    const {\n      data: {\n        publicUrl\n      }\n    } = supabase.storage.from('cso-logos').getPublicUrl(fileName);\n    return publicUrl;\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setStatus({\n      type: null,\n      message: null\n    });\n    try {\n      if (!formData.name) throw new Error('CSO name is required');\n      if (!formData.cluster) throw new Error('Cluster selection is required');\n\n      // Upload logo if selected\n      let logo_url = null;\n      if (logoFile) {\n        try {\n          logo_url = await uploadLogo(logoFile);\n          console.log('Logo uploaded successfully:', logo_url);\n        } catch (uploadError) {\n          console.error('Logo upload error:', uploadError);\n          throw new Error(`Failed to upload logo: ${uploadError.message}`);\n        }\n      }\n\n      // Insert into cso table\n      console.log('Inserting into cso table:', {\n        name: formData.name,\n        description: formData.description,\n        cluster: formData.cluster,\n        subscription: formData.subscription,\n        logo_url\n      });\n      const {\n        data: csoData,\n        error: csoError\n      } = await supabase.from('cso').insert([{\n        name: formData.name,\n        description: formData.description,\n        cluster: formData.cluster,\n        subscription: formData.subscription,\n        logo_url\n      }]).select().single();\n      if (csoError) {\n        console.error('CSO table insert error:', csoError);\n        throw new Error(`Failed to create CSO: ${csoError.message}`);\n      }\n      console.log('CSO created successfully:', csoData);\n\n      // Link executives if any are selected\n      if (formData.executives.length > 0) {\n        const executivesToLink = formData.executives.map(execId => ({\n          cso_id: csoData.id,\n          exec_id: execId,\n          portfolio: 'Member',\n          can_post: true,\n          start_date: new Date().toISOString().split('T')[0]\n        }));\n        console.log('Inserting into cso_exec table:', executivesToLink);\n        const {\n          error: linkError\n        } = await supabase.from('cso_exec').insert(executivesToLink);\n        if (linkError) {\n          console.error('CSO_EXEC table insert error:', linkError);\n\n          // Attempt to delete the CSO since executive linking failed\n          try {\n            await supabase.from('cso').delete().eq('id', csoData.id);\n            console.log('Rolled back CSO creation due to executive linking failure');\n          } catch (deleteError) {\n            console.error('Failed to rollback CSO creation:', deleteError);\n          }\n          throw new Error(`Failed to link executives: ${linkError.message}`);\n        }\n        console.log('Executives linked successfully');\n      }\n\n      // Success\n      setStatus({\n        type: 'success',\n        message: 'CSO created successfully!'\n      });\n\n      // Reset form\n      setFormData({\n        name: '',\n        description: '',\n        cluster: '',\n        subscription: '',\n        executives: []\n      });\n      setSelectedExecutives([]);\n      setLogoFile(null);\n      const fileInput = document.getElementById('logo-input');\n      if (fileInput) fileInput.value = '';\n\n      // Navigate after success\n      setTimeout(() => navigate('/CSO'), 2000);\n    } catch (err) {\n      console.error('Error in handleSubmit:', err);\n      setStatus({\n        type: 'error',\n        message: err.message || 'An unexpected error occurred. Please try again.'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    className: \"add-cso-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Add a club, society, or organization\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 7\n    }, this), status.message && /*#__PURE__*/_jsxDEV(\"output\", {\n      role: \"alert\",\n      className: `status-message ${status.type}`,\n      \"aria-live\": \"polite\",\n      children: status.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"cso-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Logo\", /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"logo-input\",\n          type: \"file\",\n          accept: \"image/*\",\n          onChange: handleFileChange,\n          \"aria-describedby\": \"logo-help\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n          id: \"logo-help\",\n          children: \"Upload an image file (max 5MB)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"CSO Name\", ' ', /*#__PURE__*/_jsxDEV(\"abbr\", {\n          title: \"required\",\n          \"aria-label\": \"required\",\n          children: \"*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"name\",\n          value: formData.name,\n          onChange: handleChange,\n          required: true,\n          \"aria-required\": \"true\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Description\", /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"description\",\n          value: formData.description,\n          onChange: handleChange,\n          rows: \"3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Cluster\", ' ', /*#__PURE__*/_jsxDEV(\"abbr\", {\n          title: \"required\",\n          \"aria-label\": \"required\",\n          children: \"*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"cluster\",\n          value: formData.cluster,\n          onChange: handleChange,\n          required: true,\n          \"aria-required\": \"true\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Select a cluster...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 383,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"political\",\n            children: \"Political Cluster\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"academic\",\n            children: \"Academic Cluster\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"social\",\n            children: \"Social Cluster\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"cultural\",\n            children: \"Cultural Cluster\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"religious\",\n            children: \"Religious Cluster\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"sport\",\n            children: \"WITS Sport\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"council\",\n            children: \"School Council\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"fieldset\", {\n        children: [/*#__PURE__*/_jsxDEV(\"legend\", {\n          children: \"Subscription Required\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: \"subscription\",\n            value: \"no\",\n            checked: formData.subscription === 'no',\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, this), \"No\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: \"subscription\",\n            value: \"yes\",\n            checked: formData.subscription === 'yes',\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 13\n          }, this), \"Yes\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"fieldset\", {\n        children: [/*#__PURE__*/_jsxDEV(\"legend\", {\n          children: \"Executive(s)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ExecutiveSearch, {\n          executives: executives,\n          selectedExecutives: selectedExecutives,\n          onAdd: handleAddExecutive,\n          onRemove: handleRemoveExecutive\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"menu\", {\n        className: \"form-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: loading,\n          className: \"btn btn-primary\",\n          children: loading ? 'Creating CSO...' : 'Add CSO'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => navigate('/CSO'),\n          className: \"btn btn-secondary\",\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 320,\n    columnNumber: 5\n  }, this);\n}\n_s2(AddCSO, \"Vd48jxHf6+ri4xKEMmzxE+y0xoo=\", false, function () {\n  return [useNavigate];\n});\n_c2 = AddCSO;\nexport default AddCSO;\nvar _c, _c2;\n$RefreshReg$(_c, \"ExecutiveSearch\");\n$RefreshReg$(_c2, \"AddCSO\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","supabase","jsxDEV","_jsxDEV","Fragment","_Fragment","ExecutiveSearch","executives","selectedExecutives","onAdd","onRemove","_s","search","setSearch","showSuggestions","setShowSuggestions","filteredExecutives","filter","exec","name","toLowerCase","includes","find","selected","id","handleAdd","executive","children","type","placeholder","value","onChange","e","target","onFocus","length","fileName","_jsxFileName","lineNumber","columnNumber","className","role","map","onClick","tabIndex","onKeyDown","key","_c","AddCSO","_s2","navigate","formData","setFormData","description","cluster","subscription","logoFile","setLogoFile","loading","setLoading","status","setStatus","message","setExecutives","setSelectedExecutives","fetchExecutives","data","execData","error","execError","from","select","studentNumbers","Boolean","profileData","profileError","in","executivesWithNames","profile","p","student_staff_number","full_name","err","console","handleAddExecutive","prev","handleRemoveExecutive","executiveId","handleChange","handleFileChange","file","files","startsWith","size","uploadLogo","fileExt","split","pop","Date","now","Math","random","storage","upload","publicUrl","getPublicUrl","handleSubmit","preventDefault","Error","logo_url","log","uploadError","csoData","csoError","insert","single","executivesToLink","execId","cso_id","exec_id","portfolio","can_post","start_date","toISOString","linkError","delete","eq","deleteError","fileInput","document","getElementById","setTimeout","onSubmit","accept","title","required","rows","checked","disabled","_c2","$RefreshReg$"],"sources":["C:/Programming/Clubs Connect/Clubs-Connect/src/components/addCSO.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../supabaseClient';\r\n\r\nfunction ExecutiveSearch({ executives, selectedExecutives, onAdd, onRemove }) {\r\n  const [search, setSearch] = useState('');\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n\r\n  const filteredExecutives = executives.filter(\r\n    (exec) =>\r\n      exec.name.toLowerCase().includes(search.toLowerCase()) &&\r\n      !selectedExecutives.find((selected) => selected.id === exec.id)\r\n  );\r\n\r\n  const handleAdd = (executive) => {\r\n    onAdd(executive);\r\n    setSearch('');\r\n    setShowSuggestions(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <search>\r\n        <input\r\n          type=\"search\"\r\n          placeholder=\"Type to search executives...\"\r\n          value={search}\r\n          onChange={(e) => setSearch(e.target.value)}\r\n          onFocus={() => setShowSuggestions(true)}\r\n          aria-label=\"Search executives\"\r\n          aria-autocomplete=\"list\"\r\n          aria-expanded={\r\n            showSuggestions && search && filteredExecutives.length > 0\r\n          }\r\n        />\r\n\r\n        {showSuggestions && search && filteredExecutives.length > 0 && (\r\n          <>\r\n            <ul className=\"suggestions-dropdown\" role=\"listbox\">\r\n              {filteredExecutives.map((exec) => (\r\n                <li\r\n                  key={exec.id}\r\n                  onClick={() => handleAdd(exec)}\r\n                  role=\"option\"\r\n                  tabIndex={0}\r\n                  onKeyDown={(e) => e.key === 'Enter' && handleAdd(exec)}\r\n                >\r\n                  {exec.name}\r\n                </li>\r\n              ))}\r\n            </ul>\r\n            <button\r\n              className=\"overlay\"\r\n              onClick={() => setShowSuggestions(false)}\r\n              aria-label=\"Close suggestions\"\r\n              type=\"button\"\r\n            />\r\n          </>\r\n        )}\r\n      </search>\r\n\r\n      {selectedExecutives.length > 0 && (\r\n        <output aria-label=\"Selected executives\">\r\n          <strong>Selected executives:</strong>\r\n          <ul className=\"executive-chips\">\r\n            {selectedExecutives.map((exec) => (\r\n              <li key={exec.id} className=\"chip\">\r\n                {exec.name}\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => onRemove(exec.id)}\r\n                  aria-label={`Remove ${exec.name}`}\r\n                  className=\"remove-btn\"\r\n                >\r\n                  ×\r\n                </button>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </output>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nfunction AddCSO() {\r\n  const navigate = useNavigate();\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    description: '',\r\n    cluster: '',\r\n    subscription: '',\r\n    executives: [],\r\n  });\r\n  const [logoFile, setLogoFile] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [status, setStatus] = useState({ type: null, message: null });\r\n  const [executives, setExecutives] = useState([]);\r\n  const [selectedExecutives, setSelectedExecutives] = useState([]);\r\n\r\n  useEffect(() => {\r\n    fetchExecutives();\r\n  }, []);\r\n\r\n  const fetchExecutives = async () => {\r\n    try {\r\n      const { data: execData, error: execError } = await supabase\r\n        .from('executive')\r\n        .select('id, \"student/staff_number\"');\r\n\r\n      if (execError) throw execError;\r\n\r\n      if (execData?.length > 0) {\r\n        const studentNumbers = execData\r\n          .map((exec) => exec['student/staff_number'])\r\n          .filter(Boolean);\r\n\r\n        if (studentNumbers.length > 0) {\r\n          const { data: profileData, error: profileError } = await supabase\r\n            .from('profiles')\r\n            .select('id, full_name')\r\n            .in('id', studentNumbers);\r\n\r\n          if (profileError) throw profileError;\r\n\r\n          const executivesWithNames = execData.map((exec) => {\r\n            const profile = profileData?.find(\r\n              (p) => p.id === exec['student/staff_number']\r\n            );\r\n            return {\r\n              id: exec.id,\r\n              student_staff_number: exec['student/staff_number'],\r\n              name: profile?.full_name || 'Unknown Executive',\r\n            };\r\n          });\r\n\r\n          setExecutives(executivesWithNames);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching executives:', err);\r\n      setStatus({ type: 'error', message: 'Failed to load executives' });\r\n    }\r\n  };\r\n\r\n  const handleAddExecutive = (executive) => {\r\n    setSelectedExecutives([...selectedExecutives, executive]);\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      executives: [...prev.executives, executive.id],\r\n    }));\r\n  };\r\n\r\n  const handleRemoveExecutive = (executiveId) => {\r\n    setSelectedExecutives((prev) =>\r\n      prev.filter((exec) => exec.id !== executiveId)\r\n    );\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      executives: prev.executives.filter((id) => id !== executiveId),\r\n    }));\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n\r\n    if (!file.type.startsWith('image/')) {\r\n      setStatus({ type: 'error', message: 'Please select an image file' });\r\n      return;\r\n    }\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      setStatus({ type: 'error', message: 'File size must be less than 5MB' });\r\n      return;\r\n    }\r\n    setLogoFile(file);\r\n    setStatus({ type: null, message: null });\r\n  };\r\n\r\n  const uploadLogo = async (file) => {\r\n    const fileExt = file.name.split('.').pop();\r\n    const fileName = `${Date.now()}-${Math.random()}.${fileExt}`;\r\n\r\n    const { data, error } = await supabase.storage\r\n      .from('cso-logos') // Use the new bucket\r\n      .upload(fileName, file);\r\n\r\n    if (error) throw error;\r\n\r\n    const {\r\n      data: { publicUrl },\r\n    } = supabase.storage.from('cso-logos').getPublicUrl(fileName);\r\n\r\n    return publicUrl;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setStatus({ type: null, message: null });\r\n\r\n    try {\r\n      if (!formData.name) throw new Error('CSO name is required');\r\n      if (!formData.cluster) throw new Error('Cluster selection is required');\r\n\r\n      // Upload logo if selected\r\n      let logo_url = null;\r\n      if (logoFile) {\r\n        try {\r\n          logo_url = await uploadLogo(logoFile);\r\n          console.log('Logo uploaded successfully:', logo_url);\r\n        } catch (uploadError) {\r\n          console.error('Logo upload error:', uploadError);\r\n          throw new Error(`Failed to upload logo: ${uploadError.message}`);\r\n        }\r\n      }\r\n\r\n      // Insert into cso table\r\n      console.log('Inserting into cso table:', {\r\n        name: formData.name,\r\n        description: formData.description,\r\n        cluster: formData.cluster,\r\n        subscription: formData.subscription,\r\n        logo_url,\r\n      });\r\n\r\n      const { data: csoData, error: csoError } = await supabase\r\n        .from('cso')\r\n        .insert([\r\n          {\r\n            name: formData.name,\r\n            description: formData.description,\r\n            cluster: formData.cluster,\r\n            subscription: formData.subscription,\r\n            logo_url,\r\n          },\r\n        ])\r\n        .select()\r\n        .single();\r\n\r\n      if (csoError) {\r\n        console.error('CSO table insert error:', csoError);\r\n        throw new Error(`Failed to create CSO: ${csoError.message}`);\r\n      }\r\n\r\n      console.log('CSO created successfully:', csoData);\r\n\r\n      // Link executives if any are selected\r\n      if (formData.executives.length > 0) {\r\n        const executivesToLink = formData.executives.map((execId) => ({\r\n          cso_id: csoData.id,\r\n          exec_id: execId,\r\n          portfolio: 'Member',\r\n          can_post: true,\r\n          start_date: new Date().toISOString().split('T')[0],\r\n        }));\r\n\r\n        console.log('Inserting into cso_exec table:', executivesToLink);\r\n\r\n        const { error: linkError } = await supabase\r\n          .from('cso_exec')\r\n          .insert(executivesToLink);\r\n\r\n        if (linkError) {\r\n          console.error('CSO_EXEC table insert error:', linkError);\r\n\r\n          // Attempt to delete the CSO since executive linking failed\r\n          try {\r\n            await supabase.from('cso').delete().eq('id', csoData.id);\r\n            console.log(\r\n              'Rolled back CSO creation due to executive linking failure'\r\n            );\r\n          } catch (deleteError) {\r\n            console.error('Failed to rollback CSO creation:', deleteError);\r\n          }\r\n\r\n          throw new Error(`Failed to link executives: ${linkError.message}`);\r\n        }\r\n\r\n        console.log('Executives linked successfully');\r\n      }\r\n\r\n      // Success\r\n      setStatus({ type: 'success', message: 'CSO created successfully!' });\r\n\r\n      // Reset form\r\n      setFormData({\r\n        name: '',\r\n        description: '',\r\n        cluster: '',\r\n        subscription: '',\r\n        executives: [],\r\n      });\r\n      setSelectedExecutives([]);\r\n      setLogoFile(null);\r\n\r\n      const fileInput = document.getElementById('logo-input');\r\n      if (fileInput) fileInput.value = '';\r\n\r\n      // Navigate after success\r\n      setTimeout(() => navigate('/CSO'), 2000);\r\n    } catch (err) {\r\n      console.error('Error in handleSubmit:', err);\r\n      setStatus({\r\n        type: 'error',\r\n        message:\r\n          err.message || 'An unexpected error occurred. Please try again.',\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"add-cso-container\">\r\n      <h1>Add a club, society, or organization</h1>\r\n\r\n      {status.message && (\r\n        <output\r\n          role=\"alert\"\r\n          className={`status-message ${status.type}`}\r\n          aria-live=\"polite\"\r\n        >\r\n          {status.message}\r\n        </output>\r\n      )}\r\n\r\n      <form onSubmit={handleSubmit} className=\"cso-form\">\r\n        <label>\r\n          Logo\r\n          <input\r\n            id=\"logo-input\"\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            onChange={handleFileChange}\r\n            aria-describedby=\"logo-help\"\r\n          />\r\n          <small id=\"logo-help\">Upload an image file (max 5MB)</small>\r\n        </label>\r\n\r\n        <label>\r\n          CSO Name{' '}\r\n          <abbr title=\"required\" aria-label=\"required\">\r\n            *\r\n          </abbr>\r\n          <input\r\n            type=\"text\"\r\n            name=\"name\"\r\n            value={formData.name}\r\n            onChange={handleChange}\r\n            required\r\n            aria-required=\"true\"\r\n          />\r\n        </label>\r\n\r\n        <label>\r\n          Description\r\n          <textarea\r\n            name=\"description\"\r\n            value={formData.description}\r\n            onChange={handleChange}\r\n            rows=\"3\"\r\n          />\r\n        </label>\r\n\r\n        <label>\r\n          Cluster{' '}\r\n          <abbr title=\"required\" aria-label=\"required\">\r\n            *\r\n          </abbr>\r\n          <select\r\n            name=\"cluster\"\r\n            value={formData.cluster}\r\n            onChange={handleChange}\r\n            required\r\n            aria-required=\"true\"\r\n          >\r\n            <option value=\"\">Select a cluster...</option>\r\n            <option value=\"political\">Political Cluster</option>\r\n            <option value=\"academic\">Academic Cluster</option>\r\n            <option value=\"social\">Social Cluster</option>\r\n            <option value=\"cultural\">Cultural Cluster</option>\r\n            <option value=\"religious\">Religious Cluster</option>\r\n            <option value=\"sport\">WITS Sport</option>\r\n            <option value=\"council\">School Council</option>\r\n          </select>\r\n        </label>\r\n\r\n        <fieldset>\r\n          <legend>Subscription Required</legend>\r\n          <label>\r\n            <input\r\n              type=\"radio\"\r\n              name=\"subscription\"\r\n              value=\"no\"\r\n              checked={formData.subscription === 'no'}\r\n              onChange={handleChange}\r\n            />\r\n            No\r\n          </label>\r\n          <label>\r\n            <input\r\n              type=\"radio\"\r\n              name=\"subscription\"\r\n              value=\"yes\"\r\n              checked={formData.subscription === 'yes'}\r\n              onChange={handleChange}\r\n            />\r\n            Yes\r\n          </label>\r\n        </fieldset>\r\n\r\n        <fieldset>\r\n          <legend>Executive(s)</legend>\r\n          <ExecutiveSearch\r\n            executives={executives}\r\n            selectedExecutives={selectedExecutives}\r\n            onAdd={handleAddExecutive}\r\n            onRemove={handleRemoveExecutive}\r\n          />\r\n        </fieldset>\r\n\r\n        <menu className=\"form-actions\">\r\n          <button type=\"submit\" disabled={loading} className=\"btn btn-primary\">\r\n            {loading ? 'Creating CSO...' : 'Add CSO'}\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => navigate('/CSO')}\r\n            className=\"btn btn-secondary\"\r\n          >\r\n            Cancel\r\n          </button>\r\n        </menu>\r\n      </form>\r\n    </main>\r\n  );\r\n}\r\n\r\nexport default AddCSO;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}